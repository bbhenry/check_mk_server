#!/bin/bash
# Automated On-call Rotation Notification


EMAIL="$HOME/bin/mail"
HOSTSUBJECT="$NOTIFY_NOTIFICATIONTYPE $NOTIFY_HOSTALIAS"
SERVICESUBJECT="$NOTIFY_NOTIFICATIONTYPE $NOTIFY_HOSTALIAS $NOTIFY_SERVICEDESC"

FLAG=1
PRIMARY="someone@somedomain.com"
SECONDARY="someone2@somedomain.com"


# For Service notification
if [ "$NOTIFY_WHAT" = "SERVICE" ]; then
	if [[ -z $NOTIFY_NOTIFICATIONCOMMENT ]]
	then
		echo "$NOTIFY_SERVICEOUTPUT" | $EMAIL -s "$SERVICESUBJECT" $PRIMARY, $SECONDARY
	else
		echo "<$NOTIFY_NOTIFICATIONCOMMENT> (by $NOTIFY_NOTIFICATIONAUTHORNAME) $NOTIFY_SERVICEOUTPUT" | $EMAIL -s "$SERVICESUBJECT" $PRIMARY, $SECONDARY
	fi

# For Host notification
else
	if [[ -z $NOTIFY_NOTIFICATIONCOMMENT ]]
	then
		echo "$NOTIFY_HOSTOUTPUT" | $EMAIL -s "$HOSTSUBJECT" $PRIMARY, $SECONDARY
	else
		echo "<$NOTIFY_NOTIFICATIONCOMMENT> (by $NOTIFY_NOTIFICATIONAUTHORNAME) $NOTIFY_HOSTOUTPUT" | $EMAIL -s "$HOSTSUBJECT" $PRIMARY, $SECONDARY
	fi
fi
